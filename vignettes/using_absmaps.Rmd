---
title: "Using the absmaps package"
author: "Will Mackey"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Using the absmaps package}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)

```


The `absmaps` package does four things to simplify the process of mapping Australian data:

1. **downloads** particular spatial data (`maps`) from the Australian Bureau of Statistics (`abs`);
    * This presently includes `sa1`, `sa2`, `sa3`, `sa4`, `gcc`, `ra` and `state` ASGS data from 2011 and 2016, with more to be included with time.
1. **compresses** the original 'shapefile' data to something more manageable, without losing important detail;
1. **converts** the shapefile data to an `sf` (simple feature) object;
1. **saves** and **loads** the resulting `sf` object for easy use with `dplyr` and `ggplot`.

Before we get into the 'what problem is this package solving' details, let's look at some examples so that you can copy-paste into your own console and replicate out-of-the-box. 


## Show me how to make a map

The function `load_abs`, with `download = TRUE` (the default), will download, compress, convert and load the spatial data you request. The output is an `sf` object that can be joined to a standard data.frame or tibble:

```{r}
library(absmaps)
library(ggplot2)
library(dplyr)


mapdata <- load_absmaps("sa4", year = 2016)

```

The `sf` object contains one observation per area (in this example, one observation per `sa4`). It stores the geometry information in the `geometry` variable, which is a list describing the area's polygon.

```{r}
head(mapdata)
```

We do all this so we can create maps. And from there, plotting a map via `ggplot` and `geom_sf` is simple:

```{r}

mapdata %>% 
  filter(gcc == "Greater Melbourne") %>%   # let's just look Melbourne
  ggplot() +
  geom_sf(aes(geometry = geometry,  # use the geometry variable
              fill = areasqkm),     # fill by area size
          lwd = 0,                  # remove borders
          show.legend = FALSE) +    # remove legend
  theme_void() +                    # clears other plot elements
  coord_sf(datum = NA)              # fixes a gridline bug in theme_void()


```

## Joining with actual data

And, most importantly

## How-and-why it works


